CREATE TABLE EMP (
  EMPNO INT PRIMARY KEY,
  ENAME VARCHAR(20),
  JOB VARCHAR(20),
  MGRNO INT,
  HIREDATE DATE,
  SAL DECIMAL(7,2),
  COMM DECIMAL(7,2),
  DEPTNO INT,
  FOREIGN KEY (DEPTNO) REFERENCES DEPT(DEPTNO),
  FOREIGN KEY (MGRNO) REFERENCES EMP(EMPNO)
);

CREATE TABLE DEPT (
  DEPTNO INT PRIMARY KEY,
  DNAME VARCHAR(20),
  LOCATION VARCHAR(20)
);

INSERT INTO DEPT VALUES
(10, 'ACCOUNTING', 'NEW YORK'),
(20, 'RESEARCH', 'DALLAS'),
(30, 'SALES', 'CHICAGO'),
(40, 'OPERATIONS', 'BOSTON');


INSERT INTO EMP VALUES
(7369, 'SMITH', 'CLERK', 7902, '1980-12-17', 800.00, NULL, 20),
(7499, 'ALLEN', 'SALESMAN', 7698, '1981-02-20', 1600.00, 300.00, 30),
(7521, 'WARD', 'SALESMAN', 7698, '1981-02-22', 1250.00, 500.00, 30),
(7566, 'JONES', 'MANAGER', 7839, '1981-04-02', 2975.00, NULL, 20),
(7654, 'MARTIN', 'SALESMAN', 7698, '1981-09-28', 1250.00, 1400.00, 30),
(7698, 'BLAKE', 'MANAGER', 7839, '1981-05-01', 2850.00, NULL, 30),
(7782, 'CLARK', 'MANAGER', 7839, '1981-06-09', 2450.00, NULL, 10),
(7788, 'SCOTT', 'ANALYST', 7566, '1982-12-09', 3000.00, NULL, 20),
(7839, 'KING', 'PRESIDENT', NULL, '1981-11-17', 5000.00, NULL, 10),
(7844, 'TURNER', 'SALESMAN', 7698, '1981-09-08', 1500.00, 0.00, 30),
(7876, 'ADAMS', 'CLERK', 7788, '1983-01-12', 1100.00, NULL, 20),
(7900, 'JAMES', 'CLERK', 7698, '1981-12-03', 950.00, NULL, 30),
(7902, 'FORD', 'ANALYST', 7566, '1981-12-03', 3000.00, NULL, 20),
(7934, 'MILLER', 'CLERK', 7782, '1982-01-23', 1300.00, NULL, 10);


SELECT ENAME
FROM EMP
WHERE JOB = 'SALESMAN' AND COMM IS NOT NULL
ORDER BY ENAME;


SELECT E.ENAME, M.ENAME AS MNAME FROM EMP E, EMP M WHERE E.MGRNO 
= M.EMPNO AND E.SAL > M.SAL;


SELECT E.ENAME, M.ENAME AS MNAME
FROM EMP E, EMP M
WHERE E.MGRNO = M.EMPNO AND E.SAL > M.SAL;

SELECT D.DNAME, E.ENAME, E.SAL
FROM EMP E JOIN DEPT D ON E.DEPTNO = D.DEPTNO
WHERE E.SAL = (SELECT MAX(SAL) FROM EMP WHERE DEPTNO = E.DEPTNO)
ORDER BY D.DNAME;

SELECT D.DNAME, COUNT(E.EMPNO) AS NUM_EMPLOYEES, AVG(E.SAL) AS AVG_SALARY
FROM DEPT D
JOIN EMP E ON D.DEPTNO = E.DEPTNO
GROUP BY D.DNAME
ORDER BY NUM_EMPLOYEES DESC
 ;

UPDATE EMP SET SAL = SAL * 1.05 WHERE deptno IN (SELECT deptno 
 FROM DEPT WHERE dname = 'CONSULTING' OR dname = 'MARKETING' );
 
 SELECT *FROM EMP




